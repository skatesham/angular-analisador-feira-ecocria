<div class="min-h-screen bg-surface-50 dark:bg-surface-950 py-8 md:py-12">
  <div class="container mx-auto px-4 md:px-6">
    <div class="max-w-6xl mx-auto">
      <!-- Header -->
      <div class="text-center mb-12">
        <h1 class="text-3xl md:text-4xl font-bold text-surface-900 dark:text-surface-0 mb-3">
          Como Funciona
        </h1>
        <p class="text-lg text-surface-600 dark:text-surface-300">
          Entenda o processo completo de an√°lise de vendas
        </p>
      </div>

      <!-- Fluxo Visual -->
      <div 
        pAnimateOnScroll 
        enterClass="animate-enter fade-in-10 animate-duration-1000"
        class="mb-12"
      >
        <div class="flex flex-col md:flex-row items-center justify-between gap-4">
          <div class="text-center flex-1">
            <div class="w-16 h-16 bg-primary/10 rounded-full flex items-center justify-center mx-auto mb-3">
              <i class="pi pi-file text-3xl text-primary"></i>
            </div>
            <h3 class="font-bold text-surface-900 dark:text-surface-0 mb-2">1. TXT de Feira</h3>
            <p class="text-sm text-surface-600 dark:text-surface-300">Suas anota√ß√µes simples</p>
          </div>

          <div class="flex items-center justify-center md:block hidden">
            <i class="pi pi-arrow-right text-2xl text-surface-400 dark:text-surface-500"></i>
          </div>
          <div class="flex items-center justify-center md:hidden">
            <i class="pi pi-arrow-down text-2xl text-surface-400 dark:text-surface-500"></i>
          </div>

          <div class="text-center flex-1">
            <div class="w-16 h-16 bg-emerald-500/10 rounded-full flex items-center justify-center mx-auto mb-3">
              <i class="pi pi-cog text-3xl text-emerald-500"></i>
            </div>
            <h3 class="font-bold text-surface-900 dark:text-surface-0 mb-2">2. Processamento</h3>
            <p class="text-sm text-surface-600 dark:text-surface-300">Categoriza√ß√£o autom√°tica</p>
          </div>

          <div class="flex items-center justify-center md:block hidden">
            <i class="pi pi-arrow-right text-2xl text-surface-400 dark:text-surface-500"></i>
          </div>
          <div class="flex items-center justify-center md:hidden">
            <i class="pi pi-arrow-down text-2xl text-surface-400 dark:text-surface-500"></i>
          </div>

          <div class="text-center flex-1">
            <div class="w-16 h-16 bg-sky-500/10 rounded-full flex items-center justify-center mx-auto mb-3">
              <i class="pi pi-chart-line text-3xl text-sky-500"></i>
            </div>
            <h3 class="font-bold text-surface-900 dark:text-surface-0 mb-2">3. Insights</h3>
            <p class="text-sm text-surface-600 dark:text-surface-300">KPIs e gr√°ficos</p>
          </div>

          <div class="flex items-center justify-center md:block hidden">
            <i class="pi pi-arrow-right text-2xl text-surface-400 dark:text-surface-500"></i>
          </div>
          <div class="flex items-center justify-center md:hidden">
            <i class="pi pi-arrow-down text-2xl text-surface-400 dark:text-surface-500"></i>
          </div>

          <div class="text-center flex-1">
            <div class="w-16 h-16 bg-violet-500/10 rounded-full flex items-center justify-center mx-auto mb-3">
              <i class="pi pi-download text-3xl text-violet-500"></i>
            </div>
            <h3 class="font-bold text-surface-900 dark:text-surface-0 mb-2">4. CSV Final</h3>
            <p class="text-sm text-surface-600 dark:text-surface-300">Dados padronizados</p>
          </div>
        </div>
      </div>

      <!-- Card de Refer√™ncia -->
      <div 
        pAnimateOnScroll 
        enterClass="animate-enter fade-in-10 zoom-in-50 animate-duration-1000"
        class="mb-12"
      >
        <p-card>
          <div class="text-center py-6">
            <i class="pi pi-book text-5xl text-primary mb-4 block"></i>
            <h3 class="text-2xl font-bold text-surface-900 dark:text-surface-0 mb-3">
              Abreviaturas e Categorias Reconhecidas
            </h3>
            <p class="text-surface-600 dark:text-surface-300 mb-6 max-w-2xl mx-auto">
              O sistema reconhece automaticamente mais de 40 tipos de produtos e suas categorias. 
              Veja a lista completa de abreviaturas aceitas.
            </p>
            <p-button 
              label="Ver Lista Completa" 
              icon="pi pi-list"
              (onClick)="mostrarDialog()"
              [outlined]="true"
              size="large"
            />
          </div>
        </p-card>
      </div>

      <!-- Exemplos -->
      <div 
        pAnimateOnScroll 
        enterClass="animate-enter fade-in-10 slide-in-from-t-20 animate-duration-1000"
        class="mb-12"
      >
        <p-card>
          <ng-template pTemplate="header">
            <div class="p-4 border-b border-surface-200 dark:border-surface-700">
              <h2 class="text-2xl font-bold text-surface-900 dark:text-surface-0">
                Exemplos de Entrada e Sa√≠da
              </h2>
            </div>
          </ng-template>

          <p-tabs value="0">
            <p-tabpanel value="0">
              <ng-template pTemplate="header">
                <i class="pi pi-file-edit mr-2"></i>
                <span>TXT de Entrada</span>
              </ng-template>
              <div class="p-4">
                <h3 class="font-semibold text-surface-900 dark:text-surface-0 mb-3">
                  Formato de Anota√ß√£o Simples
                </h3>
                <p class="text-surface-600 dark:text-surface-300 mb-4">
                  Suas anota√ß√µes de feira seguem um padr√£o simples: data da feira seguida dos produtos vendidos com valor e quantidade.
                </p>
                <pre class="bg-surface-900 dark:bg-surface-950 text-emerald-400 p-4 rounded-lg overflow-x-auto text-sm">{{ exemploTxt }}</pre>
                <div class="mt-4 p-4 bg-sky-500/10 rounded-lg border border-sky-500/20">
                  <p class="text-sm text-surface-700 dark:text-surface-200">
                    <i class="pi pi-info-circle text-sky-500 mr-2"></i>
                    <strong>Formato:</strong> "valor quantidade descri√ß√£o" ou apenas "valor descri√ß√£o" (quantidade = 1)
                  </p>
                </div>
              </div>
            </p-tabpanel>

            <p-tabpanel value="1">
              <ng-template pTemplate="header">
                <i class="pi pi-table mr-2"></i>
                <span>CSV Final</span>
              </ng-template>
              <div class="p-4">
                <h3 class="font-semibold text-surface-900 dark:text-surface-0 mb-3">
                  Dados Padronizados e Categorizados
                </h3>
                <p class="text-surface-600 dark:text-surface-300 mb-4">
                  O sistema categoriza automaticamente seus produtos e gera um CSV padronizado pronto para an√°lise.
                </p>
                <div class="overflow-x-auto">
                  <pre class="bg-surface-900 dark:bg-surface-950 text-emerald-400 p-4 rounded-lg text-xs">{{ exemploCsv }}</pre>
                </div>
                <div class="mt-4 p-4 bg-emerald-500/10 rounded-lg border border-emerald-500/20">
                  <p class="text-sm text-surface-700 dark:text-surface-200">
                    <i class="pi pi-check-circle text-emerald-500 mr-2"></i>
                    <strong>Categoriza√ß√£o autom√°tica:</strong> 40+ tipos de produtos reconhecidos (Caixa, Acess√≥rio, Escultura, etc.)
                  </p>
                </div>
              </div>
            </p-tabpanel>

            <p-tabpanel value="2">
              <ng-template pTemplate="header">
                <i class="pi pi-chart-bar mr-2"></i>
                <span>Gr√°ficos e KPIs</span>
              </ng-template>
              <div class="p-4">
                <h3 class="font-semibold text-surface-900 dark:text-surface-0 mb-3">
                  Visualiza√ß√µes Autom√°ticas
                </h3>
                <p class="text-surface-600 dark:text-surface-300 mb-4">
                  O painel gera automaticamente KPIs e gr√°ficos para voc√™ entender suas vendas.
                </p>
                
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-6">
                  <div class="bg-surface-0 dark:bg-surface-900 p-4 rounded-lg border border-surface-200 dark:border-surface-700">
                    <h4 class="font-semibold text-surface-900 dark:text-surface-0 mb-2">üìä KPIs Principais</h4>
                    <ul class="space-y-2 text-sm text-surface-600 dark:text-surface-300">
                      <li class="flex items-center gap-2">
                        <i class="pi pi-check text-emerald-500"></i>
                        Faturamento Total
                      </li>
                      <li class="flex items-center gap-2">
                        <i class="pi pi-check text-emerald-500"></i>
                        Feiras Registradas
                      </li>
                      <li class="flex items-center gap-2">
                        <i class="pi pi-check text-emerald-500"></i>
                        Ticket M√©dio por Feira
                      </li>
                      <li class="flex items-center gap-2">
                        <i class="pi pi-check text-emerald-500"></i>
                        Itens Vendidos
                      </li>
                    </ul>
                  </div>

                  <div class="bg-surface-0 dark:bg-surface-900 p-4 rounded-lg border border-surface-200 dark:border-surface-700">
                    <h4 class="font-semibold text-surface-900 dark:text-surface-0 mb-2">üìà Gr√°ficos</h4>
                    <ul class="space-y-2 text-sm text-surface-600 dark:text-surface-300">
                      <li class="flex items-center gap-2">
                        <i class="pi pi-chart-bar text-sky-500"></i>
                        Top 10 Produtos
                      </li>
                      <li class="flex items-center gap-2">
                        <i class="pi pi-chart-pie text-violet-500"></i>
                        Participa√ß√£o por Tipo
                      </li>
                      <li class="flex items-center gap-2">
                        <i class="pi pi-chart-line text-emerald-500"></i>
                        Evolu√ß√£o Semanal
                      </li>
                    </ul>
                  </div>
                </div>

                <div class="p-4 bg-yellow-500/10 rounded-lg border border-yellow-500/20">
                  <h4 class="font-semibold text-surface-900 dark:text-surface-0 mb-2">
                    <i class="pi pi-lightbulb text-yellow-500 mr-2"></i>
                    "O que isso sugere"
                  </h4>
                  <p class="text-sm text-surface-700 dark:text-surface-200">
                    Insights autom√°ticos baseados em regras determin√≠sticas: concentra√ß√£o de vendas, itens campe√µes, produtos raros, etc.
                  </p>
                </div>
              </div>
            </p-tabpanel>

            <p-tabpanel value="3">
              <ng-template pTemplate="header">
                <i class="pi pi-tags mr-2"></i>
                <span>Categorias</span>
              </ng-template>
              <div class="p-4">
                <h3 class="font-semibold text-surface-900 dark:text-surface-0 mb-3">
                  Categoriza√ß√£o Autom√°tica Completa
                </h3>
                <p class="text-surface-600 dark:text-surface-300 mb-4">
                  O sistema reconhece automaticamente <strong>40+ tipos de produtos</strong> e <strong>13 categorias/subcategorias</strong> espec√≠ficas. Consulte a tabela completa abaixo:
                </p>

                <!-- Tabela de Categoriza√ß√£o -->
                <div class="overflow-x-auto mb-6">
                  <table class="w-full text-sm border-collapse">
                    <thead>
                      <tr class="bg-surface-100 dark:bg-surface-800">
                        <th class="text-left p-3 font-semibold text-surface-900 dark:text-surface-0 border border-surface-200 dark:border-surface-700">Palavra-chave</th>
                        <th class="text-left p-3 font-semibold text-surface-900 dark:text-surface-0 border border-surface-200 dark:border-surface-700">Tipo</th>
                        <th class="text-left p-3 font-semibold text-surface-900 dark:text-surface-0 border border-surface-200 dark:border-surface-700">Categoria/Subcategoria</th>
                      </tr>
                    </thead>
                    <tbody class="text-surface-700 dark:text-surface-200">
                      <tr><td class="p-2 border border-surface-200 dark:border-surface-700">chav</td><td class="p-2 border border-surface-200 dark:border-surface-700">Acess√≥rio</td><td class="p-2 border border-surface-200 dark:border-surface-700">Chaveiro</td></tr>
                      <tr><td class="p-2 border border-surface-200 dark:border-surface-700">ping</td><td class="p-2 border border-surface-200 dark:border-surface-700">Acess√≥rio</td><td class="p-2 border border-surface-200 dark:border-surface-700">Pingente</td></tr>
                      <tr><td class="p-2 border border-surface-200 dark:border-surface-700">brinc</td><td class="p-2 border border-surface-200 dark:border-surface-700">Acess√≥rio</td><td class="p-2 border border-surface-200 dark:border-surface-700">Brinco</td></tr>
                      <tr><td class="p-2 border border-surface-200 dark:border-surface-700">anel</td><td class="p-2 border border-surface-200 dark:border-surface-700">Acess√≥rio</td><td class="p-2 border border-surface-200 dark:border-surface-700">Anel</td></tr>
                      <tr><td class="p-2 border border-surface-200 dark:border-surface-700">colar</td><td class="p-2 border border-surface-200 dark:border-surface-700">Acess√≥rio</td><td class="p-2 border border-surface-200 dark:border-surface-700">Pingente</td></tr>
                      <tr><td class="p-2 border border-surface-200 dark:border-surface-700">amulet</td><td class="p-2 border border-surface-200 dark:border-surface-700">Acess√≥rio</td><td class="p-2 border border-surface-200 dark:border-surface-700">Pingente</td></tr>
                      <tr><td class="p-2 border border-surface-200 dark:border-surface-700">apoio cel / suporte celular</td><td class="p-2 border border-surface-200 dark:border-surface-700">Acess√≥rio</td><td class="p-2 border border-surface-200 dark:border-surface-700">Suporte</td></tr>
                      <tr><td class="p-2 border border-surface-200 dark:border-surface-700">porta</td><td class="p-2 border border-surface-200 dark:border-surface-700">Acess√≥rio</td><td class="p-2 border border-surface-200 dark:border-surface-700">Porta Toalha</td></tr>
                      <tr><td class="p-2 border border-surface-200 dark:border-surface-700">tabua</td><td class="p-2 border border-surface-200 dark:border-surface-700">T√°bua</td><td class="p-2 border border-surface-200 dark:border-surface-700">-</td></tr>
                      <tr><td class="p-2 border border-surface-200 dark:border-surface-700">caix / box</td><td class="p-2 border border-surface-200 dark:border-surface-700">Caixa</td><td class="p-2 border border-surface-200 dark:border-surface-700">-</td></tr>
                      <tr><td class="p-2 border border-surface-200 dark:border-surface-700">kur / kuripe / tepi</td><td class="p-2 border border-surface-200 dark:border-surface-700">Kuripe</td><td class="p-2 border border-surface-200 dark:border-surface-700">-</td></tr>
                      <tr><td class="p-2 border border-surface-200 dark:border-surface-700">escult / passaro</td><td class="p-2 border border-surface-200 dark:border-surface-700">Escultura</td><td class="p-2 border border-surface-200 dark:border-surface-700">-</td></tr>
                      <tr><td class="p-2 border border-surface-200 dark:border-surface-700">qc</td><td class="p-2 border border-surface-200 dark:border-surface-700">Brinquedo</td><td class="p-2 border border-surface-200 dark:border-surface-700">Quebra-cabe√ßa</td></tr>
                      <tr><td class="p-2 border border-surface-200 dark:border-surface-700">carri / carro / caminh</td><td class="p-2 border border-surface-200 dark:border-surface-700">Brinquedo</td><td class="p-2 border border-surface-200 dark:border-surface-700">Carrinho</td></tr>
                      <tr><td class="p-2 border border-surface-200 dark:border-surface-700">pente</td><td class="p-2 border border-surface-200 dark:border-surface-700">Pente</td><td class="p-2 border border-surface-200 dark:border-surface-700">-</td></tr>
                      <tr><td class="p-2 border border-surface-200 dark:border-surface-700">palito</td><td class="p-2 border border-surface-200 dark:border-surface-700">Palito Cabelo</td><td class="p-2 border border-surface-200 dark:border-surface-700">-</td></tr>
                      <tr><td class="p-2 border border-surface-200 dark:border-surface-700">lumina / lumin√°</td><td class="p-2 border border-surface-200 dark:border-surface-700">Lumin√°rias</td><td class="p-2 border border-surface-200 dark:border-surface-700">-</td></tr>
                      <tr><td class="p-2 border border-surface-200 dark:border-surface-700">incens</td><td class="p-2 border border-surface-200 dark:border-surface-700">Incens√°rio</td><td class="p-2 border border-surface-200 dark:border-surface-700">-</td></tr>
                      <tr><td class="p-2 border border-surface-200 dark:border-surface-700">rap√©</td><td class="p-2 border border-surface-200 dark:border-surface-700">Rap√©</td><td class="p-2 border border-surface-200 dark:border-surface-700">-</td></tr>
                      <tr><td class="p-2 border border-surface-200 dark:border-surface-700">frame</td><td class="p-2 border border-surface-200 dark:border-surface-700">Quadro</td><td class="p-2 border border-surface-200 dark:border-surface-700">-</td></tr>
                      <tr><td class="p-2 border border-surface-200 dark:border-surface-700">rolling</td><td class="p-2 border border-surface-200 dark:border-surface-700">Bandeja Rolling</td><td class="p-2 border border-surface-200 dark:border-surface-700">-</td></tr>
                      <tr><td class="p-2 border border-surface-200 dark:border-surface-700">ufo</td><td class="p-2 border border-surface-200 dark:border-surface-700">Disco Voador</td><td class="p-2 border border-surface-200 dark:border-surface-700">-</td></tr>
                      <tr><td class="p-2 border border-surface-200 dark:border-surface-700">encome / impres</td><td class="p-2 border border-surface-200 dark:border-surface-700">Encomenda</td><td class="p-2 border border-surface-200 dark:border-surface-700">-</td></tr>
                    </tbody>
                  </table>
                </div>

                <div class="p-4 bg-sky-500/10 rounded-lg border border-sky-500/20">
                  <h4 class="font-semibold text-surface-900 dark:text-surface-0 mb-2">
                    <i class="pi pi-info-circle text-sky-500 mr-2"></i>
                    Como funciona?
                  </h4>
                  <p class="text-sm text-surface-700 dark:text-surface-200">
                    O sistema busca por essas palavras-chave na descri√ß√£o do produto. Por exemplo: "chav madeira" ser√° categorizado como <strong>Acess√≥rio ‚Üí Chaveiro</strong>.
                  </p>
                </div>
              </div>
            </p-tabpanel>
          </p-tabs>
        </p-card>
      </div>

      <!-- CTA -->
      <div 
        pAnimateOnScroll 
        enterClass="animate-enter fade-in-10 zoom-in-50 animate-duration-1000"
        class="text-center"
      >
        <p-card styleClass="bg-gradient-to-br from-primary/10 to-surface-0 dark:from-primary/5 dark:to-surface-900">
          <h3 class="text-2xl font-bold text-surface-900 dark:text-surface-0 mb-4">
            Pronto para analisar suas vendas?
          </h3>
          <p class="text-surface-600 dark:text-surface-300 mb-6">
            Envie seus arquivos TXT e veja os resultados em menos de 2 minutos
          </p>
          <p-button 
            label="Come√ßar Agora" 
            icon="pi pi-arrow-right"
            size="large"
            (onClick)="irParaAnalisador()"
          />
        </p-card>
      </div>
    </div>
  </div>
</div>

<!-- Dialog Headless com Tabelas -->
<p-dialog 
  [(visible)]="dialogVisible" 
  [modal]="true" 
  [style]="{ width: '95vw', maxWidth: '1400px' }"
  [draggable]="false"
  [resizable]="false"
  [closable]="false"
  [showHeader]="false"
  styleClass="headless-confirm"
>
  <div class="p-6">
    <div class="flex justify-between items-center mb-6">
      <h2 class="text-2xl font-bold text-surface-900 dark:text-surface-0">
        Refer√™ncia de Categoriza√ß√£o
      </h2>
      <p-button 
        icon="pi pi-times" 
        [text]="true" 
        [rounded]="true"
        (onClick)="dialogVisible = false"
      />
    </div>

    <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
      <!-- Tabela de Categoriza√ß√£o de Tipo (PRODUCT_TYPES) -->
      <div>
        <h3 class="text-lg font-semibold text-surface-900 dark:text-surface-0 mb-3">
          Categoriza√ß√£o de Tipo ({{ tiposCategorias.length }})
        </h3>
        <div class="border border-surface-200 dark:border-surface-700 rounded-lg overflow-hidden">
          <p-table 
            [value]="tiposCategorias" 
            [scrollable]="true" 
            scrollHeight="500px"
            styleClass="p-datatable-sm"
          >
            <ng-template pTemplate="header">
              <tr>
                <th>Abreviatura</th>
                <th>Tipo</th>
              </tr>
            </ng-template>
            <ng-template pTemplate="body" let-item>
              <tr>
                <td>
                  <code class="bg-surface-100 dark:bg-surface-800 px-2 py-1 rounded text-sm font-mono">
                    {{ item.abrev }}
                  </code>
                </td>
                <td>{{ item.tipo }}</td>
              </tr>
            </ng-template>
          </p-table>
        </div>
      </div>

      <!-- Tabela de Categoriza√ß√£o de Categoria (PRODUCT_CATEGORIES) -->
      <div>
        <h3 class="text-lg font-semibold text-surface-900 dark:text-surface-0 mb-3">
          Categoriza√ß√£o de Categoria ({{ categoriasDetalhadas.length }})
        </h3>
        <div class="border border-surface-200 dark:border-surface-700 rounded-lg overflow-hidden">
          <p-table 
            [value]="categoriasDetalhadas" 
            [scrollable]="true" 
            scrollHeight="500px"
            styleClass="p-datatable-sm"
          >
            <ng-template pTemplate="header">
              <tr>
                <th>Abreviatura</th>
                <th>Categoria</th>
              </tr>
            </ng-template>
            <ng-template pTemplate="body" let-item>
              <tr>
                <td>
                  <code class="bg-surface-100 dark:bg-surface-800 px-2 py-1 rounded text-sm font-mono">
                    {{ item.abrev }}
                  </code>
                </td>
                <td>{{ item.categoria }}</td>
              </tr>
            </ng-template>
          </p-table>
        </div>
      </div>

      <!-- Tabela de Tipos Agrupados -->
      <div>
        <h3 class="text-lg font-semibold text-surface-900 dark:text-surface-0 mb-3">
          Tipos e Categorias Agrupadas ({{ tiposAgrupados.length }})
        </h3>
        <div class="border border-surface-200 dark:border-surface-700 rounded-lg overflow-hidden">
          <p-table 
            [value]="tiposAgrupados" 
            [scrollable]="true" 
            scrollHeight="500px"
            styleClass="p-datatable-sm"
          >
            <ng-template pTemplate="header">
              <tr>
                <th>Tipo</th>
                <th>Categorias</th>
              </tr>
            </ng-template>
            <ng-template pTemplate="body" let-item>
              <tr>
                <td><strong>{{ item.tipo }}</strong></td>
                <td>
                  <span class="text-sm text-surface-600 dark:text-surface-300">
                    {{ item.categorias }}
                  </span>
                </td>
              </tr>
            </ng-template>
          </p-table>
        </div>
      </div>
    </div>

    <div class="mt-6 p-4 bg-sky-500/10 rounded-lg border border-sky-500/20">
      <p class="text-sm text-surface-700 dark:text-surface-200">
        <i class="pi pi-info-circle text-sky-500 mr-2"></i>
        <strong>Dica:</strong> Use essas abreviaturas nos seus arquivos TXT para garantir categoriza√ß√£o autom√°tica precisa.
      </p>
    </div>
  </div>
</p-dialog>
